2026-02-14 23:27:36,261 - INFO - Starting parallel evaluation with 40 threads
2026-02-14 23:27:36,261 - INFO - Logs will be saved to: PRISM-Guided-Learning/out/results/100_20260214_23-27-36/feedback_LLM_gemini-2.5-pro
2026-02-14 23:29:26,171 - INFO - Completed gridworld 6: LTL Score = 0.9418 (iterations: 1)
2026-02-14 23:29:50,399 - INFO - Completed gridworld 7: LTL Score = 0.9847 (iterations: 1)
2026-02-14 23:29:54,309 - INFO - Completed gridworld 11: LTL Score = 0.9488 (iterations: 1)
2026-02-14 23:30:05,710 - INFO - Completed gridworld 19: LTL Score = 0.9891 (iterations: 1)
2026-02-14 23:30:14,568 - INFO - Completed gridworld 8: LTL Score = 0.9584 (iterations: 1)
2026-02-14 23:30:15,119 - INFO - Completed gridworld 10: LTL Score = 0.9836 (iterations: 1)
2026-02-14 23:30:34,714 - INFO - Completed gridworld 16: LTL Score = 0.9805 (iterations: 1)
2026-02-14 23:30:39,846 - INFO - Completed gridworld 29: LTL Score = 0.9941 (iterations: 1)
2026-02-14 23:30:47,550 - INFO - Completed gridworld 36: LTL Score = 0.9553 (iterations: 1)
2026-02-14 23:30:56,597 - INFO - Completed gridworld 39: LTL Score = 1.0000 (iterations: 1)
2026-02-14 23:31:07,504 - INFO - Completed gridworld 38: LTL Score = 0.9999 (iterations: 1)
2026-02-14 23:31:07,805 - INFO - Completed gridworld 31: LTL Score = 0.9987 (iterations: 1)
2026-02-14 23:31:08,215 - INFO - Completed gridworld 40: LTL Score = 1.0000 (iterations: 1)
2026-02-14 23:32:43,048 - INFO - Completed gridworld 17: LTL Score = 0.9607 (iterations: 2)
2026-02-14 23:32:47,026 - INFO - Completed gridworld 43: LTL Score = 0.9289 (iterations: 1)
2026-02-14 23:33:43,257 - INFO - Completed gridworld 12: LTL Score = 0.9798 (iterations: 2)
2026-02-14 23:34:35,355 - INFO - Completed gridworld 26: LTL Score = 0.9845 (iterations: 2)
2026-02-14 23:34:45,494 - INFO - Completed gridworld 21: LTL Score = 0.9933 (iterations: 2)
2026-02-14 23:35:22,657 - INFO - Completed gridworld 45: LTL Score = 0.9538 (iterations: 1)
2026-02-14 23:35:58,930 - INFO - Completed gridworld 14: LTL Score = 0.9841 (iterations: 3)
2026-02-14 23:36:46,814 - INFO - Completed gridworld 32: LTL Score = 0.9371 (iterations: 2)
2026-02-14 23:37:04,051 - INFO - Completed gridworld 13: LTL Score = 0.9215 (iterations: 3)
2026-02-14 23:37:28,338 - INFO - Completed gridworld 34: LTL Score = 0.9798 (iterations: 2)
2026-02-14 23:38:58,084 - INFO - Completed gridworld 57: LTL Score = 1.0000 (iterations: 1)
2026-02-14 23:38:58,252 - INFO - Completed gridworld 25: LTL Score = 0.9757 (iterations: 3)
2026-02-14 23:39:15,289 - INFO - Completed gridworld 58: LTL Score = 0.9973 (iterations: 1)
2026-02-14 23:39:58,579 - INFO - Completed gridworld 59: LTL Score = 0.9995 (iterations: 1)
2026-02-14 23:40:13,875 - INFO - Completed gridworld 2: LTL Score = 0.9406 (iterations: 5)
2026-02-14 23:40:21,862 - INFO - Completed gridworld 5: LTL Score = 0.9377 (iterations: 5)
2026-02-14 23:40:41,611 - INFO - Completed gridworld 18: LTL Score = 0.8093 (iterations: 5)
2026-02-14 23:41:32,705 - INFO - Completed gridworld 3: LTL Score = 0.9403 (iterations: 5)
2026-02-14 23:42:02,342 - INFO - Completed gridworld 4: LTL Score = 0.9302 (iterations: 5)
2026-02-14 23:42:53,952 - INFO - Completed gridworld 27: LTL Score = 0.8740 (iterations: 5)
2026-02-14 23:43:19,437 - INFO - Completed gridworld 20: LTL Score = 0.8627 (iterations: 5)
2026-02-14 23:43:21,134 - INFO - Completed gridworld 1: LTL Score = 0.9017 (iterations: 5)
2026-02-14 23:43:23,774 - INFO - Completed gridworld 28: LTL Score = 0.9394 (iterations: 5)
2026-02-14 23:43:45,174 - INFO - Completed gridworld 15: LTL Score = 0.8278 (iterations: 5)
2026-02-14 23:43:56,724 - INFO - Completed gridworld 24: LTL Score = 0.9187 (iterations: 5)
2026-02-14 23:44:03,471 - INFO - Completed gridworld 66: LTL Score = 0.9958 (iterations: 1)
2026-02-14 23:44:18,953 - INFO - Completed gridworld 69: LTL Score = 0.9467 (iterations: 1)
2026-02-14 23:44:23,935 - INFO - Completed gridworld 22: LTL Score = 0.8380 (iterations: 5)
2026-02-14 23:45:23,989 - INFO - Completed gridworld 23: LTL Score = 0.9075 (iterations: 5)
2026-02-14 23:45:31,002 - INFO - Completed gridworld 68: LTL Score = 0.9996 (iterations: 1)
2026-02-14 23:45:36,635 - INFO - Completed gridworld 9: LTL Score = 0.9174 (iterations: 5)
2026-02-14 23:47:04,356 - INFO - Completed gridworld 63: LTL Score = 0.9404 (iterations: 2)
2026-02-14 23:47:21,272 - INFO - Completed gridworld 37: LTL Score = 0.9232 (iterations: 5)
2026-02-14 23:47:36,295 - INFO - Completed gridworld 73: LTL Score = 0.9906 (iterations: 1)
2026-02-14 23:47:55,504 - INFO - Completed gridworld 46: LTL Score = 0.8976 (iterations: 5)
2026-02-14 23:48:20,952 - INFO - Completed gridworld 42: LTL Score = 0.9043 (iterations: 5)
2026-02-14 23:48:35,017 - INFO - Completed gridworld 35: LTL Score = 0.9039 (iterations: 5)
2026-02-14 23:48:47,251 - INFO - Completed gridworld 50: LTL Score = 0.9075 (iterations: 5)
2026-02-14 23:48:54,876 - INFO - Completed gridworld 62: LTL Score = 0.9552 (iterations: 3)
2026-02-14 23:49:08,517 - INFO - Completed gridworld 80: LTL Score = 0.9947 (iterations: 1)
2026-02-14 23:49:20,282 - INFO - Completed gridworld 30: LTL Score = 0.9159 (iterations: 5)
2026-02-14 23:50:01,591 - INFO - Completed gridworld 48: LTL Score = 0.9097 (iterations: 5)
2026-02-14 23:50:29,424 - INFO - Completed gridworld 83: LTL Score = 0.9856 (iterations: 1)
2026-02-14 23:50:45,031 - INFO - Completed gridworld 44: LTL Score = 0.8889 (iterations: 5)
2026-02-14 23:51:05,154 - INFO - Completed gridworld 84: LTL Score = 0.9909 (iterations: 1)
2026-02-14 23:51:53,149 - INFO - Completed gridworld 33: LTL Score = 0.9336 (iterations: 5)
2026-02-14 23:52:19,036 - INFO - Completed gridworld 49: LTL Score = 0.8524 (iterations: 5)
2026-02-14 23:52:30,984 - INFO - Completed gridworld 67: LTL Score = 0.9555 (iterations: 3)
2026-02-14 23:52:32,657 - INFO - Completed gridworld 71: LTL Score = 0.9825 (iterations: 2)
2026-02-14 23:52:41,491 - INFO - Completed gridworld 53: LTL Score = 0.9438 (iterations: 5)
2026-02-14 23:52:56,372 - INFO - Completed gridworld 54: LTL Score = 0.8338 (iterations: 5)
2026-02-14 23:53:30,772 - INFO - Completed gridworld 90: LTL Score = 0.9999 (iterations: 1)
2026-02-14 23:53:40,088 - INFO - Completed gridworld 65: LTL Score = 0.9806 (iterations: 3)
2026-02-14 23:54:08,671 - INFO - Completed gridworld 41: LTL Score = 0.9273 (iterations: 5)
2026-02-14 23:54:22,228 - INFO - Completed gridworld 56: LTL Score = 0.8607 (iterations: 5)
2026-02-14 23:54:34,477 - INFO - Completed gridworld 93: LTL Score = 0.9918 (iterations: 1)
2026-02-14 23:55:09,557 - INFO - Completed gridworld 51: LTL Score = 0.9259 (iterations: 5)
2026-02-14 23:55:16,809 - INFO - Completed gridworld 96: LTL Score = 0.9949 (iterations: 1)
2026-02-14 23:55:34,395 - INFO - Completed gridworld 52: LTL Score = 0.9215 (iterations: 5)
2026-02-14 23:56:50,829 - INFO - Completed gridworld 99: LTL Score = 0.9453 (iterations: 1)
2026-02-14 23:56:52,716 - INFO - Completed gridworld 55: LTL Score = 0.8779 (iterations: 5)
2026-02-14 23:57:03,820 - INFO - Completed gridworld 60: LTL Score = 0.8962 (iterations: 5)
2026-02-14 23:57:32,926 - INFO - Completed gridworld 47: LTL Score = 0.8213 (iterations: 5)
2026-02-14 23:57:35,919 - INFO - Completed gridworld 100: LTL Score = 0.9988 (iterations: 1)
2026-02-15 00:01:30,106 - INFO - Completed gridworld 72: LTL Score = 0.9571 (iterations: 4)
2026-02-15 00:02:04,223 - INFO - Completed gridworld 74: LTL Score = 0.9840 (iterations: 4)
2026-02-15 00:02:05,931 - INFO - Completed gridworld 82: LTL Score = 1.0000 (iterations: 3)
2026-02-15 00:03:11,214 - INFO - Completed gridworld 64: LTL Score = 0.9284 (iterations: 5)
2026-02-15 00:03:16,134 - INFO - Completed gridworld 61: LTL Score = 0.9692 (iterations: 5)
2026-02-15 00:06:20,533 - INFO - Completed gridworld 70: LTL Score = 0.9920 (iterations: 5)
2026-02-15 00:07:03,969 - INFO - Completed gridworld 77: LTL Score = 0.8512 (iterations: 5)
2026-02-15 00:07:59,647 - INFO - Completed gridworld 75: LTL Score = 0.8054 (iterations: 5)
2026-02-15 00:08:14,810 - INFO - Completed gridworld 78: LTL Score = 0.9051 (iterations: 5)
2026-02-15 00:08:21,920 - INFO - Completed gridworld 85: LTL Score = 0.9815 (iterations: 4)
2026-02-15 00:09:32,437 - INFO - Completed gridworld 79: LTL Score = 0.9228 (iterations: 5)
2026-02-15 00:11:49,549 - INFO - Completed gridworld 76: LTL Score = 0.9819 (iterations: 5)
2026-02-15 00:12:10,829 - INFO - Completed gridworld 81: LTL Score = 0.7861 (iterations: 5)
2026-02-15 00:13:12,871 - INFO - Completed gridworld 88: LTL Score = 0.9082 (iterations: 5)
2026-02-15 00:14:25,462 - ERROR - Gridworld 94 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:14:25,503 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:14:30,630 - ERROR - Gridworld 91 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:14:30,636 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:14:53,823 - ERROR - Gridworld 89 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:14:53,830 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:15:23,056 - ERROR - Gridworld 92 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:15:23,063 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:15:34,304 - ERROR - Gridworld 87 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:15:34,330 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:15:52,045 - ERROR - Gridworld 97 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:15:52,051 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:16:09,290 - ERROR - Gridworld 86 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:16:09,296 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:16:41,549 - ERROR - Gridworld 98 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:16:41,576 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:16:54,498 - ERROR - Gridworld 95 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-15 00:16:54,504 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 165, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackLLMPlanner.py", line 474, in step
    response = self.model.invoke(feedback_prompt)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-15 00:16:54,513 - INFO - Total parallel evaluation time: 2958.25 seconds
