2026-02-11 11:23:10,254 - INFO - Starting parallel evaluation with 50 threads
2026-02-11 11:23:10,254 - INFO - Logs will be saved to: PRISM-Guided-Learning/out/results/50_20260211_05-59-39/feedback_minus_LLM_gemini-2.5-pro
2026-02-11 11:23:43,028 - ERROR - Gridworld 49 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,035 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,265 - ERROR - Gridworld 40 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,270 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,294 - ERROR - Gridworld 18 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,299 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,329 - ERROR - Gridworld 1 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,335 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,420 - ERROR - Gridworld 26 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,426 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,497 - ERROR - Gridworld 14 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,503 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,538 - ERROR - Gridworld 22 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,546 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,561 - ERROR - Gridworld 50 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,566 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,606 - ERROR - Gridworld 15 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,612 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,632 - ERROR - Gridworld 48 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,637 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,677 - ERROR - Gridworld 42 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,682 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,745 - ERROR - Gridworld 29 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,751 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,764 - ERROR - Gridworld 8 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,769 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,774 - ERROR - Gridworld 24 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,779 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,800 - ERROR - Gridworld 43 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,807 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,807 - ERROR - Gridworld 5 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,814 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,832 - ERROR - Gridworld 31 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,837 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,861 - ERROR - Gridworld 13 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,866 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:43,947 - ERROR - Gridworld 39 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:43,952 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,076 - ERROR - Gridworld 16 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,083 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,083 - ERROR - Gridworld 47 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,088 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,103 - ERROR - Gridworld 32 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,108 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,168 - ERROR - Gridworld 11 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,174 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,181 - ERROR - Gridworld 2 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,187 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,188 - ERROR - Gridworld 17 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,195 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,226 - ERROR - Gridworld 25 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,233 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,270 - ERROR - Gridworld 27 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,275 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,278 - ERROR - Gridworld 45 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,283 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,293 - ERROR - Gridworld 4 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,301 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,301 - ERROR - Gridworld 20 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,306 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,381 - ERROR - Gridworld 33 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,387 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,387 - ERROR - Gridworld 23 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,392 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,399 - ERROR - Gridworld 36 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,405 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,409 - ERROR - Gridworld 35 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,415 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,455 - ERROR - Gridworld 6 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,461 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,463 - ERROR - Gridworld 12 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,469 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,552 - ERROR - Gridworld 9 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,558 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,577 - ERROR - Gridworld 3 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,583 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,641 - ERROR - Gridworld 41 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,647 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,684 - ERROR - Gridworld 19 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,690 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,725 - ERROR - Gridworld 46 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,731 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,732 - ERROR - Gridworld 44 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,739 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,830 - ERROR - Gridworld 37 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,836 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,877 - ERROR - Gridworld 7 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,882 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:44,889 - ERROR - Gridworld 34 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:44,895 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:45,005 - ERROR - Gridworld 28 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:45,011 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:45,091 - ERROR - Gridworld 21 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:45,097 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:45,119 - ERROR - Gridworld 30 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:45,125 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:45,205 - ERROR - Gridworld 38 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:45,211 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:45,826 - ERROR - Gridworld 10 failed with error: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}
2026-02-11 11:23:45,832 - ERROR - Traceback (most recent call last):
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3047, in _generate
    response: GenerateContentResponse = self.client.models.generate_content(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        **request,
        ^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 5474, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/models.py", line 4214, in _generate_content
    response = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1386, in request
    response = self._request(http_request, http_options, stream=False)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1220, in _request
    return retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__
    do = self.iter(retry_state=retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter
    result = action(retry_state)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check
    raise retry_exc.reraise()
          ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise
    raise self.last_attempt.result()
          ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__
    result = fn(*args, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/_api_client.py", line 1199, in _request_once
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response
    cls.raise_error(response.status_code, response_json, response)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error
    raise ClientError(status_code, response_json, response)
google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 175, in _evaluate_parallel
    result = future.result()
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 57, in _evaluate_single_gridworld_feedback_minus
    step_result = planner.step()
  File "/h/93/asherarya/coding/PRISM-LLM/PRISM-Guided-Learning/src/planners/FeedbackMinusLLMPlanner.py", line 426, in step
    response = self.model.invoke(prompt_text)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config, **kwargs)
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 5691, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 2535, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 3051, in _generate
    _handle_client_error(e, request)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/u/asherarya/miniconda3/envs/prism3/lib/python3.13/site-packages/langchain_google_genai/chat_models.py", line 145, in _handle_client_error
    raise ChatGoogleGenerativeAIError(msg) from e
langchain_google_genai.chat_models.ChatGoogleGenerativeAIError: Error calling model 'gemini-2.5-pro' (RESOURCE_EXHAUSTED): 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_requests_per_model_per_day, limit: 0', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_requests_per_model_per_day', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel'}]}]}}

2026-02-11 11:23:45,837 - INFO - Total parallel evaluation time: 35.58 seconds
